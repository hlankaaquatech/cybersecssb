{
  "job_name" : "main_network_triage_output",
  "api_endpoints" : [ {
    "endpoint" : "triage_output_all_fields",
    "code" : "SELECT \"id\", \"ts\", \"ip_src_addr_geo_lon\", \"code\", \"method\", \"top_level_domain\", \"ip_dst_addr_geo_lon\", \"ip_dst_addr_geo_city\", \"ip_dst_addr_asn_org\", \"host_url\", \"second_level_domain\", \"ip_dst_addr_asn_mask\", \"elapsed\", \"ip_dst_addr_asn_number\", \"ip_src_addr_geo_country\", \"ip_dst_addr\", \"ip_dst_addr_geo_country\", \"ip_dst_addr_geo_lat\", \"ip_src_addr_geo_lat\", \"message_bytes\", \"domain\", \"action\", \"ip_src_addr\", \"dga_model_legit\", \"domain_no_subdomains\", \"ip_dst_addr_geo_state\", \"cyberscore_rule1_id\", \"cyberscore_rule1_score\", \"cyberscore_rule1_reason\", \"cyberscore_rule2_id\", \"cyberscore_rule2_score\", \"cyberscore_rule2_reason\" FROM mv_ffffffff_main_network_triage_output",
    "builder_data" : {
      "rules" : {
        "condition" : "AND",
        "rules" : [ ]
      },
      "selectedColumns" : [ {
        "index" : 1,
        "name" : "id",
        "alias" : "id",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 2,
        "name" : "ts",
        "alias" : "ts",
        "expr" : null,
        "typeName" : "INTEGER",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 3,
        "name" : "ip_src_addr_geo_lon",
        "alias" : "ip_src_addr_geo_lon",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 4,
        "name" : "code",
        "alias" : "code",
        "expr" : null,
        "typeName" : "INTEGER",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 5,
        "name" : "method",
        "alias" : "method",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 6,
        "name" : "top_level_domain",
        "alias" : "top_level_domain",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 7,
        "name" : "ip_dst_addr_geo_lon",
        "alias" : "ip_dst_addr_geo_lon",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 8,
        "name" : "ip_dst_addr_geo_city",
        "alias" : "ip_dst_addr_geo_city",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 9,
        "name" : "ip_dst_addr_asn_org",
        "alias" : "ip_dst_addr_asn_org",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 10,
        "name" : "host_url",
        "alias" : "host_url",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 11,
        "name" : "second_level_domain",
        "alias" : "second_level_domain",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 12,
        "name" : "ip_dst_addr_asn_mask",
        "alias" : "ip_dst_addr_asn_mask",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 13,
        "name" : "elapsed",
        "alias" : "elapsed",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 14,
        "name" : "ip_dst_addr_asn_number",
        "alias" : "ip_dst_addr_asn_number",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 15,
        "name" : "ip_src_addr_geo_country",
        "alias" : "ip_src_addr_geo_country",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 16,
        "name" : "ip_dst_addr",
        "alias" : "ip_dst_addr",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 17,
        "name" : "ip_dst_addr_geo_country",
        "alias" : "ip_dst_addr_geo_country",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 18,
        "name" : "ip_dst_addr_geo_lat",
        "alias" : "ip_dst_addr_geo_lat",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 19,
        "name" : "ip_src_addr_geo_lat",
        "alias" : "ip_src_addr_geo_lat",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 20,
        "name" : "message_bytes",
        "alias" : "message_bytes",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 21,
        "name" : "domain",
        "alias" : "domain",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 22,
        "name" : "action",
        "alias" : "action",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 23,
        "name" : "ip_src_addr",
        "alias" : "ip_src_addr",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 24,
        "name" : "dga_model_legit",
        "alias" : "dga_model_legit",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 25,
        "name" : "domain_no_subdomains",
        "alias" : "domain_no_subdomains",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 26,
        "name" : "ip_dst_addr_geo_state",
        "alias" : "ip_dst_addr_geo_state",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 27,
        "name" : "cyberscore_rule1_id",
        "alias" : "cyberscore_rule1_id",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 28,
        "name" : "cyberscore_rule1_score",
        "alias" : "cyberscore_rule1_score",
        "expr" : null,
        "typeName" : "DOUBLE",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 29,
        "name" : "cyberscore_rule1_reason",
        "alias" : "cyberscore_rule1_reason",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 30,
        "name" : "cyberscore_rule2_id",
        "alias" : "cyberscore_rule2_id",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 31,
        "name" : "cyberscore_rule2_score",
        "alias" : "cyberscore_rule2_score",
        "expr" : null,
        "typeName" : "DOUBLE",
        "primaryKey" : false,
        "watermark" : false
      }, {
        "index" : 32,
        "name" : "cyberscore_rule2_reason",
        "alias" : "cyberscore_rule2_reason",
        "expr" : null,
        "typeName" : "VARCHAR",
        "primaryKey" : false,
        "watermark" : false
      } ]
    }
  } ],
  "sql" : "select `message`.`id` as `id`\n, cast(substr(cast(`message`.`ts` as string), 1, 10) as int) as `ts`\n, `message`.`extensions`['ip_src_addr.geo.longitude'] as ip_src_addr_geo_lon\n, cast(`message`.`extensions`['code'] as int) as code\n, `message`.`extensions`['method'] as `method`\n, `message`.`extensions`['top_level_domain'] as top_level_domain\n, `message`.`extensions`['ip_dst_addr.geo.longitude'] as ip_dst_addr_geo_lon\n, `message`.`extensions`['ip_dst_addr.geo.city'] as ip_dst_addr_geo_city\n, `message`.`extensions`['ip_dst_addr.asn.org'] as ip_dst_addr_asn_org\n, `message`.`extensions`['url'] as host_url\n, `message`.`extensions`['second_level_domain'] as second_level_domain\n, `message`.`extensions`['ip_dst_addr.asn.mask'] as ip_dst_addr_asn_mask\n, `message`.`extensions`['elapsed'] as elapsed\n, `message`.`extensions`['ip_dst_addr.asn.number'] as ip_dst_addr_asn_number\n, `message`.`extensions`['ip_src_addr.geo.country'] as ip_src_addr_geo_country\n, `message`.`extensions`['ip_dst_addr'] as ip_dst_addr\n, `message`.`extensions`['ip_dst_addr.geo.country'] as ip_dst_addr_geo_country\n, `message`.`extensions`['ip_dst_addr.geo.latitude'] as ip_dst_addr_geo_lat\n, `message`.`extensions`['ip_src_addr.geo.latitude'] as ip_src_addr_geo_lat\n, `message`.`extensions`['bytes'] as message_bytes\n, `message`.`extensions`['domain'] as domain\n, `message`.`extensions`['action'] as action\n, `message`.`extensions`['ip_src_addr'] as ip_src_addr\n, `message`.`extensions`['dga_model.legit'] as dga_model_legit\n, `message`.`extensions`['domain_no_subdomains'] as domain_no_subdomains\n, `message`.`extensions`['ip_dst_addr.geo.state'] as ip_dst_addr_geo_state\n, `cyberScoresDetails`[1].`ruleId` as cyberscore_rule1_id\n, `cyberScoresDetails`[1].`score` as cyberscore_rule1_score\n, `cyberScoresDetails`[1].`reason` as cyberscore_rule1_reason\n, `cyberScoresDetails`[2].`ruleId` as cyberscore_rule2_id\n, `cyberScoresDetails`[2].`score` as cyberscore_rule2_score\n, `cyberScoresDetails`[2].`reason` as cyberscore_rule2_reason\nfrom `cybersec-sr`.`default_database`.`main.network.triage.output` \n",
  "mv_config" : {
    "name" : "main_network_triage_output",
    "retention" : 1200,
    "min_row_retention_count" : 0,
    "recreate" : false,
    "key_column_name" : "id",
    "column_indices_disabled" : false,
    "indexed_columns" : [ ],
    "not_indexed_columns" : [ ],
    "api_key" : "6a66ad86-0741-41e9-81cd-31c4e06ca33c",
    "ignore_nulls" : false,
    "require_restart" : false,
    "batch_size" : 0,
    "enabled" : true
  },
  "runtime_config" : {
    "execution_mode" : "SESSION",
    "parallelism" : 1,
    "sample_interval" : 1000,
    "sample_count" : 100,
    "window_size" : 100,
    "start_with_savepoint" : false,
    "log_config" : {
      "type" : "LOG4J_PROPERTIES",
      "content" : "\nrootLogger.level = INFO\nrootLogger.appenderRef.file.ref = MainAppender\n#Uncomment this if you want to _only_ change Flink's logging\n#logger.flink.name = org.apache.flink\n#logger.flink.level = INFO\n\n# The following lines keep the log level of common libraries/connectors on\n# log level INFO. The root logger does not override this. You have to manually\n# change the log levels here.\nlogger.akka.name = akka\nlogger.akka.level = INFO\nlogger.kafka.name= org.apache.kafka\nlogger.kafka.level = INFO\nlogger.hadoop.name = org.apache.hadoop\nlogger.hadoop.level = INFO\nlogger.zookeeper.name = org.apache.zookeeper\nlogger.zookeeper.level = INFO\n\n# Log all infos in the given file\nappender.main.name = MainAppender\nappender.main.type = File\nappender.main.append = false\nappender.main.fileName = /var/log/ssb\nappender.main.layout.type = PatternLayout\nappender.main.layout.pattern = %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %-60c %x - %m%n\n\n# Suppress the irrelevant (wrong) warnings from the Netty channel handler\nlogger.netty.name = org.apache.flink.shaded.akka.org.jboss.netty.channel.DefaultChannelPipeline\nlogger.netty.level = OFF\n"
    }
  }
}